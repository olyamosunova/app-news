(this["webpackJsonpapp-news"]=this["webpackJsonpapp-news"]||[]).push([[0],{71:function(e,t,n){},72:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(13),s=n.n(r),a=n(8),o=n(15),i=n(38),l=n(39),u=n(14),j=n.n(u),d=n(18),m=n(20),b=n.n(m),h="https://hacker-news.firebaseio.com/v0",f=n(83),O=function(e,t){return Object.assign({},e,t)},p=function(){var e=Object(d.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("".concat(h,"/item/").concat(t,".json"));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e.catch(0),console.log("Error while getting a story.");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(d.a)(j.a.mark((function e(){var t,n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("".concat(h,"/newstories.json"));case 3:return t=e.sent,n=t.data,e.next=7,Promise.all(n.slice(0,100).map(p));case 7:return c=e.sent,e.abrupt("return",c);case 11:e.prev=11,e.t0=e.catch(0),console.log("Error while getting list of stories.");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("".concat(h,"/item/").concat(t,".json"));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e.catch(0),console.log("Error while getting a comment.");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(d.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.slice(0,100).map(y));case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.log("Error while getting list of comments.");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),v=function(e){return Object(f.a)(new Date(1e3*e),"dd MMMM yyyy hh:mm")},g={stories:[],isLoading:!0,errorMessage:"",story:null,comments:[]},N="LOAD_STORIES",w="CHANGE_IS_LOADED_FLAG",E="SET_ERROR_MESSAGE",S="GET_STORY",k="LOAD_COMMENTS",M=function(e){return{type:N,payload:e}},T=function(e){return{type:w,payload:e}},A=function(e){return{type:E,payload:e}},D=function(e){return{type:S,payload:e}},L=function(e){return{type:k,payload:e}},C=function(){return function(e){x().then((function(t){e(M(t)),e(T(!1)),e(A(""))})).catch((function(){e(T(!1)),e(A("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0441\u0442\u0438!"))}))}},I=function(e){return function(t){Promise.all(e.slice(0,100).map(y)).then((function(e){t(L(e))})).catch((function(){console.log("Error while getting list of comments.")}))}},R=(n(70),n(71),n(72),n(16)),G=n(6),P=n(41),B=n(42),H=function(e){return e.stories},J=function(e){return e.isLoading},F=function(e){return e.errorMessage},U=function(e){return e.story},W=function(e){return e.comments},Y=n(40),q=n(1),z=function(){return Object(q.jsx)("div",{className:"loader",children:Object(q.jsx)(Y.a,{animation:"border"})})},K=(n(74),n(26)),Q=(n(75),function(e){var t=e.message,n=Object(a.b)(),r=function(){return n(A(""))};return Object(c.useEffect)((function(){var e=null;clearTimeout(e),e=setTimeout(r,500)}),[]),Object(q.jsx)(K.a.Dialog,{children:Object(q.jsx)(K.a.Body,{children:Object(q.jsx)("p",{children:t})})})}),V=function(){var e=Object(a.c)(H),t=Object(a.c)(J),n=Object(a.c)(F),c=Object(a.b)();console.log(e);return Object(q.jsxs)("section",{className:"main",children:[Object(q.jsx)(B.a,{className:"main__button",variant:"primary",onClick:function(){c(T(!0)),c(C())},disabled:t,children:"Update stories list"}),Object(q.jsxs)(P.a,{className:"main__table",striped:!0,bordered:!0,hover:!0,children:[Object(q.jsx)("thead",{children:Object(q.jsxs)("tr",{children:[Object(q.jsx)("td",{children:"Title"}),Object(q.jsx)("td",{children:"Score"}),Object(q.jsx)("td",{children:"Author"}),Object(q.jsx)("td",{children:"Date"})]})}),Object(q.jsx)("tbody",{children:t?Object(q.jsx)("tr",{style:{backgroundColor:"#ffffff"},children:Object(q.jsx)("td",{colSpan:"4",align:"center",children:Object(q.jsx)(z,{})})}):e?e.map((function(e){return e?Object(q.jsxs)("tr",{children:[Object(q.jsx)("td",{children:Object(q.jsx)(R.b,{to:"/story/".concat(e.id),children:e.title})}),Object(q.jsx)("td",{children:e.score?e.score:"0"}),Object(q.jsx)("td",{children:e.by}),Object(q.jsx)("td",{children:v(e.time)})]},e.id):null})):Object(q.jsx)("tr",{style:{backgroundColor:"#ffffff"},children:Object(q.jsx)("td",{colSpan:"4",align:"center",children:"\u041d\u0435\u0442 \u043d\u043e\u0432\u043e\u0441\u0442\u0435\u0439"})})})]}),n?Object(q.jsx)(Q,{message:n}):null]})},X=(n(78),n(79),n(27)),Z=function(e){var t=e.comment,n=t.kids,r=n?n.length:null,s=Object(c.useState)([]),a=Object(X.a)(s,2),o=a[0],i=a[1],l=Object(c.useState)(!0),u=Object(X.a)(l,2),j=u[0],d=u[1];return Object(q.jsxs)("li",{className:"comments__item",children:[Object(q.jsxs)("div",{className:"comments__item-header",children:[Object(q.jsx)("p",{className:"comments__item-author",children:t.by}),Object(q.jsx)("span",{className:"comments__item-date",children:v(t.time)})]}),Object(q.jsx)("div",{className:"comments__item-body",children:Object(q.jsx)("p",{className:"comments__item-text",dangerouslySetInnerHTML:{__html:t.text}})}),r&&j?Object(q.jsx)("div",{className:"comments__item-footer",children:Object(q.jsxs)("button",{onClick:function(){r&&_(n).then((function(e){i(e),d(!1)}))},className:"comments__item-btn",type:"button",children:["\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0440\u0438\u0438 (",r,")"]})}):null,r?Object(q.jsx)($,{comments:o}):null]})},$=function(e){var t=e.comments;return Object(q.jsx)("ul",{className:"comments__list",children:t.map((function(e){return Object(q.jsx)(Z,{comment:e},e.id)}))})},ee=function(e){var t=e.comments.filter((function(e){return!e.deleted}));return Object(q.jsxs)("div",{className:"story__comments comments",children:[Object(q.jsxs)("p",{className:"comments__title",children:["Comments ",Object(q.jsxs)("span",{children:["(",t.length,")"]})]}),Object(q.jsx)($,{comments:t})]})},te=function(){var e=Object(a.c)(U),t=Object(a.b)(),n=Object(a.c)(W),r=e.kids,s=r?r.length:null;return Object(c.useEffect)((function(){r&&r.length&&t(I(r))}),[]),Object(q.jsxs)("section",{className:"story",children:[Object(q.jsx)(R.b,{className:"story__return",to:"/",children:"Return to stories list"}),Object(q.jsxs)("article",{className:"story__item",children:[Object(q.jsxs)("div",{className:"story__header",children:[Object(q.jsx)("span",{className:"story__date",children:v(e.time)}),Object(q.jsxs)("p",{className:"story__author",children:["Author: ",Object(q.jsx)("span",{children:e.by})]}),Object(q.jsx)("a",{className:"story__source",href:e.url,children:"Source"})]}),Object(q.jsxs)("div",{className:"story__body",children:[Object(q.jsx)("h2",{className:"story__title",children:e.title}),s?Object(q.jsx)(ee,{comments:n}):Object(q.jsx)("p",{children:"\u041d\u0435\u0442 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432"})]})]})]})};var ne=function(){var e=Object(a.b)();return Object(q.jsx)(R.a,{children:Object(q.jsx)("div",{className:"container",children:Object(q.jsxs)(G.c,{children:[Object(q.jsx)(G.a,{path:"/",component:V,exact:!0}),Object(q.jsx)(G.a,{exact:!0,path:"/story/:id",render:function(t){return function(t){var n=Number(t.params.id);return e(D(n)),Object(q.jsx)(te,{})}(t.match)}})]})})})},ce=Object(o.createStore)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return O(e,{stories:t.payload});case w:return O(e,{isLoading:t.payload});case E:return O(e,{errorMessage:t.payload});case S:var n=t.payload,c=e.stories.find((function(e){return e.id===n}));return O(e,{story:c});case k:return O(e,{comments:t.payload});default:return e}}),Object(l.composeWithDevTools)(Object(o.applyMiddleware)(i.a)));ce.dispatch(C());var re=null;clearInterval(re),re=setInterval((function(){ce.dispatch(C())}),6e4),s.a.render(Object(q.jsx)(a.a,{store:ce,children:Object(q.jsx)(ne,{})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.46dc7295.chunk.js.map